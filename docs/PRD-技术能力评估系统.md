# 产品需求文档 (PRD) - 技术能力评估系统

**文档版本：** v1.0
**创建日期：** 2025-10-28
**产品名称：** TechEval - 工程师技术能力评估平台
**目标用户：** HR招聘官、技术面试官、应聘工程师

---

## 一、产品背景与目标

### 1.1 业务背景
公司正在招募前后端开发工程师，需要通过笔试快速评估应聘者的技术能力。传统面试方式存在以下问题：
- ❌ 笔试时间过长（1-2小时），候选人体验差
- ❌ 过于关注语法细节，忽略思维逻辑和架构能力
- ❌ 评估标准不统一，难以横向对比
- ❌ 无法准确映射到职级体系（如P5-P9）

### 1.2 产品目标
**核心价值：** 通过10分钟结构化笔试，科学评估工程师的4个核心能力，并输出可量化的职级评估报告。

**关键指标（北极星指标）：**
- 笔试完成率 ≥ 90%（10分钟时长）
- 评估准确率 ≥ 85%（与实际入职后表现对比）
- HR满意度 ≥ 4.5/5.0

---

## 二、核心能力考察维度

### 2.1 四大考察维度

| 维度 | 定义 | 考察重点 | 权重 |
|------|------|----------|------|
| **代码设计能力** | 编写清晰、规范、符合最佳实践的代码 | 设计模式、代码风格、语言特性理解 | 25% |
| **软件架构设计** | 设计可扩展、高可用的系统架构 | 微服务、缓存、消息队列、高并发处理 | 30% |
| **数据库建模** | 业务对象抽象与数据库设计 | ER建模、索引优化、查询性能、安全设计 | 25% |
| **运维能力** | 服务器环境、容器化、CI/CD | Linux命令、Docker、K8s、脚本编写 | 20% |

### 2.2 职级映射标准（MVP阶段：阿里P级）

| 总分区间 | 职级 | 能力描述 |
|---------|------|---------|
| 0-40 | P5 | 初级工程师：能独立完成简单功能开发 |
| 41-60 | P6 | 中级工程师：能独立负责模块开发 |
| 61-75 | P7 | 高级工程师：能设计复杂系统模块 |
| 76-90 | P8 | 资深工程师/Tech Lead：能架构复杂系统 |
| 91-100 | P9 | 专家/架构师：能设计大型分布式系统 |

> **注：** Google L级映射（L3-L7+）将在V2版本中支持

---

## 三、产品功能设计（MVP）

### 3.1 用户流程图

```
┌─────────────┐
│ 1. 登录注册  │ (Supabase Auth)
└──────┬──────┘
       ↓
┌─────────────────────┐
│ 2. 考试配置页        │
│ - 选择角色(前端/后端) │
│ - 选择语言           │
│ - 选择框架           │
└──────┬──────────────┘
       ↓
┌─────────────────────┐
│ 3. 考试说明页        │
│ - 考试规则           │
│ - 防作弊说明         │
│ - 时间限制           │
└──────┬──────────────┘
       ↓
┌─────────────────────┐
│ 4. 答题页面          │
│ - 倒计时器(10分钟)   │
│ - 20道题目           │
│ - 自动保存           │
│ - 防作弊监控         │
└──────┬──────────────┘
       ↓
┌─────────────────────┐
│ 5. 结果报告页        │
│ - 能力雷达图         │
│ - 职级评估           │
│ - 答案解析           │
│ - 改进建议           │
└─────────────────────┘
```

### 3.2 核心功能模块

#### 模块1：考试配置（Exam Setup）

**功能描述：** 允许应聘者根据应聘岗位选择对应的技术栈

**交互设计：**
```
┌────────────────────────────────────────┐
│  选择你应聘的岗位                        │
│  ○ 前端开发工程师                        │
│  ○ 后端开发工程师                        │
│  ○ 全栈工程师                           │
│                                        │
│  选择你最擅长的编程语言                   │
│  ○ TypeScript  ○ Java  ○ Python       │
│                                        │
│  选择你熟悉的框架                        │
│  [根据角色+语言动态显示]                  │
│  前端: ○ Next.js  ○ React (CRA)        │
│  后端: ○ Spring Boot ○ Django ○ Express│
│                                        │
│            [开始考试] →                 │
└────────────────────────────────────────┘
```

**字段定义：**
- `role`: `'frontend' | 'backend' | 'fullstack'`
- `language`: `'typescript' | 'java' | 'python'`
- `framework`: `'nextjs' | 'react' | 'spring' | 'django' | 'express'`

---

#### 模块2：静态题库（Question Bank - MVP版本）

**题库规模（MVP）：**
- 总题量：**80题**（每个维度20题）
- 每次考试：**20题**（从题库中按规则抽取）

**题目分布策略：**

| 能力维度 | 简单题 | 中等题 | 困难题 | 总计 |
|---------|-------|-------|-------|-----|
| 代码设计 | 3题 | 2题 | 0题 | 5题 |
| 软件架构 | 2题 | 2题 | 1题 | 5题 |
| 数据库建模 | 3题 | 2题 | 0题 | 5题 |
| 运维能力 | 3题 | 1题 | 1题 | 5题 |
| **总计** | **11题** | **7题** | **2题** | **20题** |

**题型分布：**
- 选择题（单选/多选）：**18题**
- 陈述题（简答）：**2题**
  - **软件架构1题（困难）**：高并发系统设计，满分5分，附带评分rubric
  - **数据库建模1题（中等/困难）**：数据库设计方案，满分5分，附带评分rubric
  - 字数限制：每题最多150字
  - 评分标准：公开评分rubric，由管理员人工评阅

**题目样例参考：**

<details>
<summary><strong>【代码设计 - 简单单选】React Hooks最佳实践</strong></summary>

```typescript
// 题目
在React函数组件中，以下哪种方式更符合获取异步数据的最佳实践？

A. const [data, setData] = useState(fetchData())
B. useEffect(() => { fetchData().then(setData) }, [])
C. const data = useMemo(() => fetchData(), [])
D. const data = useCallback(fetchData, [])()

// 正确答案: B
// 考察点: 副作用处理、useEffect使用时机
// 权重: 1分
// 适用: role=['frontend'], language=['typescript']
```
</details>

<details>
<summary><strong>【软件架构 - 困难陈述题】高并发订单系统设计</strong></summary>

```
【题目】
你需要设计一个电商系统的订单服务，需求如下：
- 预计QPS 10,000+
- 需要支持秒杀场景（瞬时QPS可达50,000）
- 保证订单不重复、不丢失

请用伪代码或文字描述你的架构设计方案，至少包括：
1. 缓存策略
2. 数据库设计（分库分表/读写分离）
3. 消息队列使用场景
4. 如何保证幂等性

【评分标准】(总分5分)
- 提到Redis/Memcached缓存热点数据: 1分
- 提到数据库分片或读写分离: 1分
- 提到消息队列削峰/异步处理: 1分
- 提到幂等性设计（唯一订单号/分布式锁）: 1分
- 方案整体合理性与可行性: 1分

【参考答案要点】
- 缓存: Redis存储库存、用户信息
- 数据库: 订单表按用户ID分片，配置读写分离
- 消息队列: Kafka异步处理订单状态变更通知
- 幂等性: 订单号使用雪花算法，Redis分布式锁防止重复下单

// 适用: role=['backend', 'fullstack'], language=['java', 'python', 'typescript']
```
</details>

<details>
<summary><strong>【数据库建模 - 中等多选】索引优化</strong></summary>

```sql
-- 题目
以下关于数据库索引的说法，哪些是正确的？（多选）

A. 在高频查询的列上创建索引可以显著提升查询性能
B. 索引越多越好，应该给所有列都加上索引
C. 联合索引(a, b, c)可以用于查询条件 WHERE a=1 AND b=2
D. WHERE子句中使用函数会导致索引失效（如 WHERE YEAR(date)=2024）

-- 正确答案: A, C, D
-- 考察点: 索引使用场景、最左前缀原则、索引失效情况
-- 权重: 1分
-- 适用: role=['backend', 'fullstack'], language=ALL
```
</details>

<details>
<summary><strong>【运维能力 - 中等单选】Docker容器网络</strong></summary>

```bash
# 题目
在Docker环境中，你需要让容器A访问容器B的服务，以下哪种方式最合理？

A. 使用容器B的IP地址直接访问（如 http://172.17.0.3:8080）
B. 将容器B的端口映射到宿主机，容器A通过宿主机IP访问
C. 将两个容器放在同一个自定义网络中，通过容器名访问
D. 使用 docker exec 进入容器A，手动配置hosts文件

# 正确答案: C
# 考察点: Docker网络模式、容器互联
# 权重: 1分
# 适用: role=['backend', 'fullstack'], language=ALL
```
</details>

---

#### 模块3：考试引擎（Exam Engine）

**功能1: 倒计时器**
- 考试时长：**10分钟（600秒）**
- UI显示：`09:45` 格式，最后1分钟红色警告
- 自动提交：时间到达0:00自动提交答案

**功能2: 防作弊监控**

| 监控类型 | 触发条件 | 处理动作 | 计入警告 |
|---------|---------|---------|---------|
| 页面失焦(page_blur) | 页面visibility变为hidden | 记录日志 | ❌ 否（仅记录） |
| 切换Tab(tab_switch) | 失焦后恢复，记录离开时长 | 警告次数+1 | ✅ 是 |
| 警告提示 | tab_switch累计1次 | 弹窗警告 (1/3)："请专注于考试，不要离开答题页面" | - |
| 最后警告 | tab_switch累计2次 | 弹窗警告 (2/3)："再切换1次，考试将被强制终止！" | - |
| 强制终止 | tab_switch累计3次 | 自动终止考试 + 标记"疑似作弊" + 跳转首页 | - |
| 鼠标/键盘空闲(idle_timeout) | 无操作5分钟 | 记录日志（仅记录，不提示） | ❌ 否（仅记录） |
| 右键菜单(context_menu) | 检测到contextmenu事件 | 阻止右键菜单显示 + 记录日志 | ❌ 否（阻止但不警告） |
| 复制(copy) | 检测到copy事件 | 阻止复制操作 + 记录日志 | ❌ 否（阻止但不警告） |
| 粘贴(paste) | 检测到paste事件 | 简答题textarea允许，其他位置阻止 + 记录日志 | ❌ 否（阻止但不警告） |

> **策略调整说明 (2025-10-28):**
> - 从原计划的"5次终止"调整为**"3次终止"**（更严格，提升考试公平性）
> - 从原计划的"仅记录复制粘贴"调整为**"阻止复制粘贴和右键"**（防止外部搜索作弊）
> - 简答题textarea允许粘贴（避免误伤正常答题）

**技术实现要点：**
```typescript
// 监听页面可见性变化
document.addEventListener('visibilitychange', () => {
  if (document.hidden) {
    // 页面失焦，记录开始时间
    blurStartTime = Date.now();
    updateCheatingWarnings();
  } else {
    // 页面恢复焦点，计算离开时长
    const duration = Date.now() - blurStartTime;
    logCheatingEvent('tab_switch', duration);
  }
});
```

**功能3: 自动保存**
- 保存频率：每**30秒**保存一次答案草稿
- 保存触发：用户切换题目时立即保存
- 断线恢复：刷新页面后可恢复到最后保存点

**功能4: 答题交互**
```
┌────────────────────────────────────────┐
│  剩余时间: 08:32              题目 3/20  │
├────────────────────────────────────────┤
│                                        │
│  【代码设计】以下哪种方式...             │
│                                        │
│  ○ A. const [data, setData] = ...      │
│  ○ B. useEffect(() => { ... })         │
│  ○ C. const data = useMemo(...)        │
│  ○ D. 以上都不推荐                      │
│                                        │
│  [标记稍后回顾] [清除选项]               │
│                                        │
│  [← 上一题]        [下一题 →]           │
│                                        │
│  题目导航: [1✓][2✓][3●][4][5]...[20]    │
│  (✓=已答 ●=当前 空=未答 🚩=标记)         │
│                                        │
│            [提交全部答案]                │
└────────────────────────────────────────┘
```

---

#### 模块4：智能评估系统（Scoring & Leveling）

**评分算法流程：**

```
Step 1: 选择题自动评分
├─ 单选题: 正确得分 = 题目权重
├─ 多选题: 全对得分 = 题目权重，部分对 = 0分
└─ 错误得分 = 0分

Step 2: 陈述题人工评分
├─ 管理员在后台评阅界面打分（0-5分）
├─ 评分维度: 方案合理性、技术深度、可行性
└─ 多位评委取平均分（MVP版本单人评分）

Step 3: 能力维度得分计算
├─ 代码设计得分 = (该维度总得分 / 该维度满分) × 100
├─ 软件架构得分 = (该维度总得分 / 该维度满分) × 100
├─ 数据库建模得分 = (该维度总得分 / 该维度满分) × 100
└─ 运维能力得分 = (该维度总得分 / 该维度满分) × 100

Step 4: 总分与职级映射
├─ 总分 = 加权平均(代码25% + 架构30% + 数据库25% + 运维20%)
└─ 职级 = 根据总分区间映射到P5-P9
```

**评分示例：**

假设某候选人答题情况：
```
代码设计（5题，满分5分）:
- 选择题4道全对 → 4分
- 总计：4/5 → 得分 80分

软件架构（5题，满分6分：4道选择题4分+1道陈述题5分满分）:
- 选择题3道对1道错 → 3分
- 陈述题人工评分 → 4/5分
- 总计：7/9 → 得分 77.8分

数据库建模（5题，满分6分）:
- 选择题4道全对 → 4分
- 陈述题人工评分 → 3/5分
- 总计：7/9 → 得分 77.8分

运维能力（5题，满分5分）:
- 选择题全对 → 5分
- 总计：5/5 → 得分 100分

加权总分 = 80×25% + 77.8×30% + 77.8×25% + 100×20%
         = 20 + 23.34 + 19.45 + 20
         = 82.79 ≈ 83分

职级评估: P8 (资深工程师/Tech Lead)
```

---

#### 模块5：结果报告页（Result Report）

**页面布局：**

```
┌─────────────────────────────────────────┐
│  🎉 考试完成！                            │
│                                         │
│  总分: 83分    职级评估: P8 (阿里)        │
├─────────────────────────────────────────┤
│                                         │
│       能力雷达图 (Radar Chart)            │
│                                         │
│              运维能力                     │
│                 100                     │
│                 /\                      │
│    代码设计 80 /  \ 78 数据库建模         │
│               /    \                    │
│              /  83  \                   │
│             /        \                  │
│            ───────────                  │
│           软件架构 78                     │
│                                         │
├─────────────────────────────────────────┤
│  📊 详细分析                              │
│                                         │
│  ✅ 优势领域: 运维能力(100分)              │
│     你在容器化部署和CI/CD方面表现优秀       │
│                                         │
│  ⚠️  提升空间: 代码设计(80分)              │
│     建议加强设计模式和代码重构能力          │
│                                         │
│  📝 答题情况: 18/20正确 (90%)             │
│     - 代码设计: 4/5                       │
│     - 软件架构: 4/5 (陈述题待评阅)         │
│     - 数据库建模: 5/5                     │
│     - 运维能力: 5/5                       │
│                                         │
│  [查看答案解析] [返回首页]                │
└─────────────────────────────────────────┘
```

**答案解析页面：**
- 展示所有题目
- 标注用户答案 vs 正确答案
- 显示详细解析
- 陈述题展示参考答案（需等待人工评阅）

---

## 四、数据库设计（Drizzle ORM）

详细Schema见 `docs/数据库Schema设计.md`

**核心表结构：**
1. `exams` - 考试模板配置
2. `questions` - 题库
3. `exam_sessions` - 考试会话
4. `answers` - 答案记录
5. `cheating_logs` - 作弊行为日志
6. `exam_results` - 考试结果
7. `users` - 用户表（关联Supabase Auth）

---

## 五、非功能性需求

### 5.1 性能要求
- 页面加载时间 < 2秒
- 答案自动保存响应 < 500ms
- 考试结果计算 < 3秒
- 支持并发考试人数 ≥ 100人

### 5.2 安全性要求
- 题库数据不在前端暴露（仅返回题目内容，不返回答案）
- 答案提交需要JWT验证
- 防止重复提交（会话状态检查）
- SQL注入防护（使用Drizzle ORM参数化查询）

### 5.3 可用性要求
- 移动端适配（响应式设计）
- 支持Chrome、Safari、Edge最新版本
- 断网恢复能力（本地保存答案草稿）

---

## 六、MVP范围外功能（未来迭代）

**V2功能（待定）：**
- ❌ LLM动态生成题目
- ❌ 摄像头监控
- ❌ 强制全屏模式
- ❌ 代码相似度检测
- ❌ 多人协作评阅
- ❌ 批量导出报告
- ❌ 题库管理后台
- ❌ Vue/Angular框架支持
- ❌ Go/Rust/C++语言支持

---

## 七、关键决策记录

| 决策点 | 选择方案 | 备选方案 | 决策理由 |
|-------|---------|---------|---------|
| 题库方式 | 静态题库（手动录入80题） | LLM动态生成 | MVP快速上线，质量可控 |
| 考试时长 | 10分钟 | 15分钟 | 降低候选人流失率 |
| 题目数量 | 20题 | 30题 | 平衡评估准确性和时间 |
| 防作弊强度 | tab切换3次终止 + 阻止复制粘贴 | 摄像头+强制全屏 | 平衡用户体验与考试公平性 |
| 切屏警告阈值 | 3次终止 | 5次终止 | 更严格防作弊（实施后调整） |
| 复制粘贴限制 | 阻止（textarea除外） | 仅记录不阻止 | 防止外部搜索作弊（实施后调整） |
| 陈述题评分 | 人工评阅 | LLM自动评分 | 保证公平性 |
| 职级映射 | 简单分数区间 | ML模型预测 | 算法透明可解释 |
| 前端框架 | Next.js | Nuxt/Remix | 团队技术栈统一 |

---

## 八、成功指标（KPI）

**上线后3个月目标：**
- 累计笔试人数 ≥ 200人
- 笔试完成率 ≥ 85%
- HR对评估结果满意度 ≥ 4.0/5.0
- 候选人投诉率 < 5%
- 评估准确率 ≥ 80%（通过入职后表现回溯验证）

---

## 九、附录

### 9.1 参考资料
- [Google SRE面试指南](https://sre.google/resources/)
- 阿里技术职级体系（P5-P9：初级→中级→高级→资深→专家）
- [LeetCode题库设计](https://leetcode.com/)
- [HackerRank评估系统](https://www.hackerrank.com/)

### 9.2 相关文档
- [数据库Schema设计](./数据库Schema设计.md)
- [任务拆解与排期](./MVP任务拆解.md)
- [题库样例](./题库样例.md)

---

**文档维护者：** Product Team
**最后更新：** 2025-10-28
